
> storycraft@0.1.0 dev
> next dev

  ‚ñ≤ Next.js 14.2.31
  - Local:        http://localhost:3000
  - Environments: .env

 ‚úì Starting...
 ‚úì Ready in 1139ms
 ‚óã Compiling / ...
request to https://fonts.gstatic.com/s/dmsans/v16/rP2Yp2ywxg089UriI5-g4vlH9VoD8Cmcqbu6-K6z9mXgjU0.woff2 failed, reason: 

Retrying 1/3...
 ‚ö† ./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx
Component rendered
 GET / 200 in 5529ms
 ‚ö† ./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx
 ‚ö† ./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx
 ‚ö† ./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'extractYouTubeMetadata' is not exported from '../actions/process-reference' (imported as 'extractYouTubeMetadata').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx

./app/components/reference-tab.tsx
Attempted import error: 'processReferenceContent' is not exported from '../actions/process-reference' (imported as 'processReferenceContent').

Import trace for requested module:
./app/components/reference-tab.tsx
./app/page.tsx
 ‚úì Compiled / in 1813ms (804 modules)
 ‚úì Compiled / in 392ms (1571 modules)
Component rendered
 GET / 200 in 577ms
Component rendered
 GET / 200 in 16ms
Component rendered
 GET / 200 in 361ms
Component rendered
Component rendered
Component rendered
 GET / 200 in 560ms
 GET / 200 in 621ms
 GET / 200 in 975ms
 ‚óã Compiling /favicon.ico ...
 ‚úì Compiled /favicon.ico in 736ms (1603 modules)
Component rendered
 GET / 200 in 227ms
Component rendered
 GET / 200 in 246ms
 GET /favicon.ico 200 in 80ms
 GET /favicon.ico 200 in 40ms
 ‚úì Compiled in 401ms (804 modules)
 ‚úì Compiled in 141ms (804 modules)
 ‚úì Compiled in 282ms (804 modules)
 ‚úì Compiled in 216ms (804 modules)
 ‚úì Compiled in 293ms (804 modules)
 ‚úì Compiled in 199ms (804 modules)
 ‚úì Compiled in 98ms (804 modules)
 ‚®Ø ./app/api/process-youtube/route.ts
Error: 
  [31mx[0m cannot reassign to a variable declared with `const`
     ,-[[36;1;4m/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/app/api/process-youtube/route.ts[0m:11:1]
 [2m 11[0m |   try {
 [2m 12[0m |     logger.info(`üöÄ [${requestId}] Starting YouTube processing request`)
 [2m 13[0m |     
 [2m 14[0m |     const { url, targetLanguage = 'ÁπÅÈ´î‰∏≠Êñá', useStructuredOutput = true } = await request.json()
     : [31;1m                                                  ^^^^^^^^^^^^^|^^^^^^^^^^^^[0m
     :                                                                [31;1m`-- [31;1mconst variable was declared here[0m[0m
 [2m 15[0m |     
 [2m 16[0m |     logger.info(`üìã [${requestId}] Request parameters:`, {
 [2m 17[0m |       url,
 [2m 18[0m |       targetLanguage,
 [2m 19[0m |       useStructuredOutput,
 [2m 20[0m |       timestamp: new Date().toISOString()
 [2m 21[0m |     })
 [2m 22[0m |     
 [2m 23[0m |     if (!url) {
 [2m 24[0m |       logger.warn(`‚ùå [${requestId}] Missing URL parameter`)
 [2m 25[0m |       return NextResponse.json(
 [2m 26[0m |         { error: 'YouTube URL is required' },
 [2m 27[0m |         { status: 400 }
 [2m 28[0m |       )
 [2m 29[0m |     }
 [2m 30[0m | 
 [2m 31[0m |     // Step 1: Initialize YouTube processing service
 [2m 32[0m |     logger.info(`üé¨ [${requestId}] Initializing YouTube processing service`)
 [2m 33[0m |     const processingService = new YouTubeProcessingService()
 [2m 34[0m |     
 [2m 35[0m |     // Step 2: Process YouTube content
 [2m 36[0m |     logger.info(`üì∫ [${requestId}] Processing YouTube content: ${url}`)
 [2m 37[0m |     const processingResult = await processingService.processYouTubeContent(
 [2m 38[0m |       url,
 [2m 39[0m |       /youtube\.com\/shorts\//.test(url) ? 'shorts' : 'auto'
 [2m 40[0m |     )
 [2m 41[0m |     
 [2m 42[0m |     logger.info(`‚úÖ [${requestId}] YouTube processing completed:`, {
 [2m 43[0m |       strategy: processingResult.processingStrategy,
 [2m 44[0m |       confidence: processingResult.confidence,
 [2m 45[0m |       hasVideoAnalysis: processingResult.hasVideoAnalysis,
 [2m 46[0m |       contentType: processingResult.contentType
 [2m 47[0m |     })
 [2m 48[0m |     
 [2m 49[0m |     if (processingResult.error) {
 [2m 50[0m |       logger.error(`‚ùå [${requestId}] Processing service returned error:`, processingResult.error)
 [2m 51[0m |       return NextResponse.json(
 [2m 52[0m |         { 
 [2m 53[0m |           error: 'YouTube processing failed',
 [2m 54[0m |           details: processingResult.error
 [2m 55[0m |         },
 [2m 56[0m |         { status: 400 }
 [2m 57[0m |       )
 [2m 58[0m |     }
 [2m 59[0m |     
 [2m 60[0m |     if (!processingResult.title) {
 [2m 61[0m |       logger.warn(`‚ö†Ô∏è [${requestId}] No title extracted from YouTube content`)
 [2m 62[0m |       return NextResponse.json(
 [2m 63[0m |         { error: 'Failed to extract YouTube metadata - no title found' },
 [2m 64[0m |         { status: 400 }
 [2m 65[0m |       )
 [2m 66[0m |     }
 [2m 67[0m | 
 [2m 68[0m |     // Step 3: Generate pitch using structured output
 [2m 69[0m |     logger.info(`ü§ñ [${requestId}] Starting pitch generation with structured output`)
 [2m 70[0m |     
 [2m 71[0m |     const content = processingResult.transcript || processingResult.description || ''
 [2m 72[0m |     const isShorts = processingResult.contentType === 'shorts'
 [2m 73[0m |     
 [2m 74[0m |     logger.info(`üìù [${requestId}] Content analysis:`, {
 [2m 75[0m |       contentLength: content.length,
 [2m 76[0m |       isShorts,
 [2m 77[0m |       hasTranscript: !!processingResult.transcript,
 [2m 78[0m |       hasVideoAnalysis: !!processingResult.hasVideoAnalysis
 [2m 79[0m |     })
 [2m 80[0m |     
 [2m 81[0m |     let generatedPitch = ''
 [2m 82[0m |     let keyTopics: string[] = []
 [2m 83[0m |     let structuredPitch = null
 [2m 84[0m |     
 [2m 85[0m |     if (useStructuredOutput && targetLanguage === 'ÁπÅÈ´î‰∏≠Êñá') {
 [2m 86[0m |       logger.info(`üèóÔ∏è [${requestId}] Using structured output for Traditional Chinese`)
 [2m 87[0m |       
 [2m 88[0m |       try {
 [2m 89[0m |         const geminiDirect = new GeminiDirectService()
 [2m 90[0m |         const structuredService = new StructuredOutputService(geminiDirect)
 [2m 91[0m |         
 [2m 92[0m |         const result = await structuredService.generateStructuredPitch(
 [2m 93[0m |           content,
 [2m 94[0m |           processingResult.transcript ? 'full' : 'partial'
 [2m 95[0m |         )
 [2m 96[0m |         
 [2m 97[0m |         if (result && result.finalPitch) {
 [2m 98[0m |           generatedPitch = result.finalPitch
 [2m 99[0m |           keyTopics = result.tags || result.characters?.map(c => c.name) || []
 [2m100[0m |           structuredPitch = result
 [2m101[0m |           logger.info(`‚úÖ [${requestId}] Structured pitch generated successfully (${generatedPitch.length} chars)`)
 [2m102[0m |         } else {
 [2m103[0m |           throw new Error('Structured output returned empty result')
 [2m104[0m |         }
 [2m105[0m |       } catch (structuredError) {
 [2m106[0m |         logger.warn(`‚ö†Ô∏è [${requestId}] Structured output failed, falling back to standard generation:`, structuredError)
 [2m107[0m |         // Fallback to standard generation
 [2m108[0m |         useStructuredOutput = false
     : [33;1m        ^^^^^^^^^|^^^^^^^^^[0m
     :                  [33;1m`-- [33;1mcannot reassign[0m[0m
 [2m109[0m |       }
 [2m110[0m |     }
 [2m111[0m |     
     `----

Import trace for requested module:
./app/api/process-youtube/route.ts
 ‚óã Compiling /_not-found ...
 ‚®Ø ./app/api/process-youtube/route.ts
Error: 
  [31mx[0m cannot reassign to a variable declared with `const`
     ,-[[36;1;4m/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/app/api/process-youtube/route.ts[0m:11:1]
 [2m 11[0m |   try {
 [2m 12[0m |     logger.info(`üöÄ [${requestId}] Starting YouTube processing request`)
 [2m 13[0m |     
 [2m 14[0m |     const { url, targetLanguage = 'ÁπÅÈ´î‰∏≠Êñá', useStructuredOutput = true } = await request.json()
     : [31;1m                                                  ^^^^^^^^^^^^^|^^^^^^^^^^^^[0m
     :                                                                [31;1m`-- [31;1mconst variable was declared here[0m[0m
 [2m 15[0m |     
 [2m 16[0m |     logger.info(`üìã [${requestId}] Request parameters:`, {
 [2m 17[0m |       url,
 [2m 18[0m |       targetLanguage,
 [2m 19[0m |       useStructuredOutput,
 [2m 20[0m |       timestamp: new Date().toISOString()
 [2m 21[0m |     })
 [2m 22[0m |     
 [2m 23[0m |     if (!url) {
 [2m 24[0m |       logger.warn(`‚ùå [${requestId}] Missing URL parameter`)
 [2m 25[0m |       return NextResponse.json(
 [2m 26[0m |         { error: 'YouTube URL is required' },
 [2m 27[0m |         { status: 400 }
 [2m 28[0m |       )
 [2m 29[0m |     }
 [2m 30[0m | 
 [2m 31[0m |     // Step 1: Initialize YouTube processing service
 [2m 32[0m |     logger.info(`üé¨ [${requestId}] Initializing YouTube processing service`)
 [2m 33[0m |     const processingService = new YouTubeProcessingService()
 [2m 34[0m |     
 [2m 35[0m |     // Step 2: Process YouTube content
 [2m 36[0m |     logger.info(`üì∫ [${requestId}] Processing YouTube content: ${url}`)
 [2m 37[0m |     const processingResult = await processingService.processYouTubeContent(
 [2m 38[0m |       url,
 [2m 39[0m |       /youtube\.com\/shorts\//.test(url) ? 'shorts' : 'auto'
 [2m 40[0m |     )
 [2m 41[0m |     
 [2m 42[0m |     logger.info(`‚úÖ [${requestId}] YouTube processing completed:`, {
 [2m 43[0m |       strategy: processingResult.processingStrategy,
 [2m 44[0m |       confidence: processingResult.confidence,
 [2m 45[0m |       hasVideoAnalysis: processingResult.hasVideoAnalysis,
 [2m 46[0m |       contentType: processingResult.contentType
 [2m 47[0m |     })
 [2m 48[0m |     
 [2m 49[0m |     if (processingResult.error) {
 [2m 50[0m |       logger.error(`‚ùå [${requestId}] Processing service returned error:`, processingResult.error)
 [2m 51[0m |       return NextResponse.json(
 [2m 52[0m |         { 
 [2m 53[0m |           error: 'YouTube processing failed',
 [2m 54[0m |           details: processingResult.error
 [2m 55[0m |         },
 [2m 56[0m |         { status: 400 }
 [2m 57[0m |       )
 [2m 58[0m |     }
 [2m 59[0m |     
 [2m 60[0m |     if (!processingResult.title) {
 [2m 61[0m |       logger.warn(`‚ö†Ô∏è [${requestId}] No title extracted from YouTube content`)
 [2m 62[0m |       return NextResponse.json(
 [2m 63[0m |         { error: 'Failed to extract YouTube metadata - no title found' },
 [2m 64[0m |         { status: 400 }
 [2m 65[0m |       )
 [2m 66[0m |     }
 [2m 67[0m | 
 [2m 68[0m |     // Step 3: Generate pitch using structured output
 [2m 69[0m |     logger.info(`ü§ñ [${requestId}] Starting pitch generation with structured output`)
 [2m 70[0m |     
 [2m 71[0m |     const content = processingResult.transcript || processingResult.description || ''
 [2m 72[0m |     const isShorts = processingResult.contentType === 'shorts'
 [2m 73[0m |     
 [2m 74[0m |     logger.info(`üìù [${requestId}] Content analysis:`, {
 [2m 75[0m |       contentLength: content.length,
 [2m 76[0m |       isShorts,
 [2m 77[0m |       hasTranscript: !!processingResult.transcript,
 [2m 78[0m |       hasVideoAnalysis: !!processingResult.hasVideoAnalysis
 [2m 79[0m |     })
 [2m 80[0m |     
 [2m 81[0m |     let generatedPitch = ''
 [2m 82[0m |     let keyTopics: string[] = []
 [2m 83[0m |     let structuredPitch = null
 [2m 84[0m |     
 [2m 85[0m |     if (useStructuredOutput && targetLanguage === 'ÁπÅÈ´î‰∏≠Êñá') {
 [2m 86[0m |       logger.info(`üèóÔ∏è [${requestId}] Using structured output for Traditional Chinese`)
 [2m 87[0m |       
 [2m 88[0m |       try {
 [2m 89[0m |         const geminiDirect = new GeminiDirectService()
 [2m 90[0m |         const structuredService = new StructuredOutputService(geminiDirect)
 [2m 91[0m |         
 [2m 92[0m |         const result = await structuredService.generateStructuredPitch(
 [2m 93[0m |           content,
 [2m 94[0m |           processingResult.transcript ? 'full' : 'partial'
 [2m 95[0m |         )
 [2m 96[0m |         
 [2m 97[0m |         if (result && result.finalPitch) {
 [2m 98[0m |           generatedPitch = result.finalPitch
 [2m 99[0m |           keyTopics = result.tags || result.characters?.map(c => c.name) || []
 [2m100[0m |           structuredPitch = result
 [2m101[0m |           logger.info(`‚úÖ [${requestId}] Structured pitch generated successfully (${generatedPitch.length} chars)`)
 [2m102[0m |         } else {
 [2m103[0m |           throw new Error('Structured output returned empty result')
 [2m104[0m |         }
 [2m105[0m |       } catch (structuredError) {
 [2m106[0m |         logger.warn(`‚ö†Ô∏è [${requestId}] Structured output failed, falling back to standard generation:`, structuredError)
 [2m107[0m |         // Fallback to standard generation
 [2m108[0m |         useStructuredOutput = false
     : [33;1m        ^^^^^^^^^|^^^^^^^^^[0m
     :                  [33;1m`-- [33;1mcannot reassign[0m[0m
 [2m109[0m |       }
 [2m110[0m |     }
 [2m111[0m |     
     `----

Import trace for requested module:
./app/api/process-youtube/route.ts
 ‚®Ø ./app/api/process-youtube/route.ts
Error: 
  [31mx[0m cannot reassign to a variable declared with `const`
     ,-[[36;1;4m/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/app/api/process-youtube/route.ts[0m:11:1]
 [2m 11[0m |   try {
 [2m 12[0m |     logger.info(`üöÄ [${requestId}] Starting YouTube processing request`)
 [2m 13[0m |     
 [2m 14[0m |     const { url, targetLanguage = 'ÁπÅÈ´î‰∏≠Êñá', useStructuredOutput = true } = await request.json()
     : [31;1m                                                  ^^^^^^^^^^^^^|^^^^^^^^^^^^[0m
     :                                                                [31;1m`-- [31;1mconst variable was declared here[0m[0m
 [2m 15[0m |     
 [2m 16[0m |     logger.info(`üìã [${requestId}] Request parameters:`, {
 [2m 17[0m |       url,
 [2m 18[0m |       targetLanguage,
 [2m 19[0m |       useStructuredOutput,
 [2m 20[0m |       timestamp: new Date().toISOString()
 [2m 21[0m |     })
 [2m 22[0m |     
 [2m 23[0m |     if (!url) {
 [2m 24[0m |       logger.warn(`‚ùå [${requestId}] Missing URL parameter`)
 [2m 25[0m |       return NextResponse.json(
 [2m 26[0m |         { error: 'YouTube URL is required' },
 [2m 27[0m |         { status: 400 }
 [2m 28[0m |       )
 [2m 29[0m |     }
 [2m 30[0m | 
 [2m 31[0m |     // Step 1: Initialize YouTube processing service
 [2m 32[0m |     logger.info(`üé¨ [${requestId}] Initializing YouTube processing service`)
 [2m 33[0m |     const processingService = new YouTubeProcessingService()
 [2m 34[0m |     
 [2m 35[0m |     // Step 2: Process YouTube content
 [2m 36[0m |     logger.info(`üì∫ [${requestId}] Processing YouTube content: ${url}`)
 [2m 37[0m |     const processingResult = await processingService.processYouTubeContent(
 [2m 38[0m |       url,
 [2m 39[0m |       /youtube\.com\/shorts\//.test(url) ? 'shorts' : 'auto'
 [2m 40[0m |     )
 [2m 41[0m |     
 [2m 42[0m |     logger.info(`‚úÖ [${requestId}] YouTube processing completed:`, {
 [2m 43[0m |       strategy: processingResult.processingStrategy,
 [2m 44[0m |       confidence: processingResult.confidence,
 [2m 45[0m |       hasVideoAnalysis: processingResult.hasVideoAnalysis,
 [2m 46[0m |       contentType: processingResult.contentType
 [2m 47[0m |     })
 [2m 48[0m |     
 [2m 49[0m |     if (processingResult.error) {
 [2m 50[0m |       logger.error(`‚ùå [${requestId}] Processing service returned error:`, processingResult.error)
 [2m 51[0m |       return NextResponse.json(
 [2m 52[0m |         { 
 [2m 53[0m |           error: 'YouTube processing failed',
 [2m 54[0m |           details: processingResult.error
 [2m 55[0m |         },
 [2m 56[0m |         { status: 400 }
 [2m 57[0m |       )
 [2m 58[0m |     }
 [2m 59[0m |     
 [2m 60[0m |     if (!processingResult.title) {
 [2m 61[0m |       logger.warn(`‚ö†Ô∏è [${requestId}] No title extracted from YouTube content`)
 [2m 62[0m |       return NextResponse.json(
 [2m 63[0m |         { error: 'Failed to extract YouTube metadata - no title found' },
 [2m 64[0m |         { status: 400 }
 [2m 65[0m |       )
 [2m 66[0m |     }
 [2m 67[0m | 
 [2m 68[0m |     // Step 3: Generate pitch using structured output
 [2m 69[0m |     logger.info(`ü§ñ [${requestId}] Starting pitch generation with structured output`)
 [2m 70[0m |     
 [2m 71[0m |     const content = processingResult.transcript || processingResult.description || ''
 [2m 72[0m |     const isShorts = processingResult.contentType === 'shorts'
 [2m 73[0m |     
 [2m 74[0m |     logger.info(`üìù [${requestId}] Content analysis:`, {
 [2m 75[0m |       contentLength: content.length,
 [2m 76[0m |       isShorts,
 [2m 77[0m |       hasTranscript: !!processingResult.transcript,
 [2m 78[0m |       hasVideoAnalysis: !!processingResult.hasVideoAnalysis
 [2m 79[0m |     })
 [2m 80[0m |     
 [2m 81[0m |     let generatedPitch = ''
 [2m 82[0m |     let keyTopics: string[] = []
 [2m 83[0m |     let structuredPitch = null
 [2m 84[0m |     
 [2m 85[0m |     if (useStructuredOutput && targetLanguage === 'ÁπÅÈ´î‰∏≠Êñá') {
 [2m 86[0m |       logger.info(`üèóÔ∏è [${requestId}] Using structured output for Traditional Chinese`)
 [2m 87[0m |       
 [2m 88[0m |       try {
 [2m 89[0m |         const geminiDirect = new GeminiDirectService()
 [2m 90[0m |         const structuredService = new StructuredOutputService(geminiDirect)
 [2m 91[0m |         
 [2m 92[0m |         const result = await structuredService.generateStructuredPitch(
 [2m 93[0m |           content,
 [2m 94[0m |           processingResult.transcript ? 'full' : 'partial'
 [2m 95[0m |         )
 [2m 96[0m |         
 [2m 97[0m |         if (result && result.finalPitch) {
 [2m 98[0m |           generatedPitch = result.finalPitch
 [2m 99[0m |           keyTopics = result.tags || result.characters?.map(c => c.name) || []
 [2m100[0m |           structuredPitch = result
 [2m101[0m |           logger.info(`‚úÖ [${requestId}] Structured pitch generated successfully (${generatedPitch.length} chars)`)
 [2m102[0m |         } else {
 [2m103[0m |           throw new Error('Structured output returned empty result')
 [2m104[0m |         }
 [2m105[0m |       } catch (structuredError) {
 [2m106[0m |         logger.warn(`‚ö†Ô∏è [${requestId}] Structured output failed, falling back to standard generation:`, structuredError)
 [2m107[0m |         // Fallback to standard generation
 [2m108[0m |         useStructuredOutput = false
     : [33;1m        ^^^^^^^^^|^^^^^^^^^[0m
     :                  [33;1m`-- [33;1mcannot reassign[0m[0m
 [2m109[0m |       }
 [2m110[0m |     }
 [2m111[0m |     
     `----

Import trace for requested module:
./app/api/process-youtube/route.ts
 POST /api/process-youtube 500 in 1954ms
 ‚úì Compiled /_error in 1112ms (1667 modules)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Initializing Gemini Service with config: {
  projectId: 'fechen-aifactory',
  location: 'us-central1',
  model: 'gemini-2.5-flash',
  timeout: 60000
}
Vertex AI client initialized successfully
üîµ INFO: üöÄ [req_1755433111137_i83bkl7wl] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755433111137_i83bkl7wl] Request parameters: {
  url: 'https://youtube.com/shorts/test123',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T12:18:31.139Z'
}
üîµ INFO: üé¨ [req_1755433111137_i83bkl7wl] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755433111137_i83bkl7wl] Processing YouTube content: https://youtube.com/shorts/test123 undefined
üîµ INFO: Attempting operation: YouTube metadata extraction (attempt 1/3) undefined
üü° WARN: Operation failed (attempt 1/3): YouTube metadata extraction {
  error: 'Video not found or not accessible',
  stack: 'Error: Video not found or not accessible\n' +
    '    at YouTubeProcessingService.extractStandardMetadata (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:161:19)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async RetryService.executeWithRetry (webpack-internal:///(rsc)/./lib/retry-service.ts:20:32)\n' +
    '    at async eval (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:79:38)\n' +
    '    at async CircuitBreaker.execute (webpack-internal:///(rsc)/./lib/retry-service.ts:129:28)\n' +
    '    at async YouTubeProcessingService.processYouTubeContent (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:77:32)\n' +
    '    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:42:34)\n' +
    '    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)\n' +
    '    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)\n' +
    '    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)\n' +
    '    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)\n' +
    '    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)\n' +
    '    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)'
}
üî¥ ERROR: Primary processing failed, attempting fallback {
  error: Error: Video not found or not accessible
      at YouTubeProcessingService.extractStandardMetadata (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:161:19)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async RetryService.executeWithRetry (webpack-internal:///(rsc)/./lib/retry-service.ts:20:32)
      at async eval (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:79:38)
      at async CircuitBreaker.execute (webpack-internal:///(rsc)/./lib/retry-service.ts:129:28)
      at async YouTubeProcessingService.processYouTubeContent (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:77:32)
      at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:42:34)
      at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
      at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
      at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
      at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
      at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
      at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
      at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
      at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
      at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
      at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
      at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
      at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
      at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
      at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
      at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
      at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
      at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
      at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13) {
    originalError: Error: Video not found or not accessible
        at YouTubeProcessingService.extractStandardMetadata (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:161:19)
        at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
        at async RetryService.executeWithRetry (webpack-internal:///(rsc)/./lib/retry-service.ts:20:32)
        at async eval (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:79:38)
        at async CircuitBreaker.execute (webpack-internal:///(rsc)/./lib/retry-service.ts:129:28)
        at async YouTubeProcessingService.processYouTubeContent (webpack-internal:///(rsc)/./lib/youtube-processing-service.ts:77:32)
        at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:42:34)
        at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
        at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
        at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
        at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
        at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
        at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
        at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
        at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
        at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
        at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
        at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
        at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
        at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
        at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
        at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
        at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
        at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
        at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13),
    context: 'YouTube metadata extraction',
    attempts: 1
  },
  videoId: 'test123'
} undefined
üü° WARN: Processing event completed {
  eventId: 'evt_1755433111139_aw4mwtnb9',
  duration: 93,
  success: false,
  strategy: 'fallback',
  error: 'Operation failed after 1 attempt(s): YouTube metadata extraction\n' +
    'Original error: Video not found or not accessible'
}
üü¢ DEBUG: Cache set: youtube:test123:shorts (type: fallback, ttl: 300000ms) undefined
üîµ INFO: ‚úÖ [req_1755433111137_i83bkl7wl] YouTube processing completed: {
  strategy: 'fallback',
  confidence: 0.5,
  hasVideoAnalysis: undefined,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755433111137_i83bkl7wl] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755433111137_i83bkl7wl] Content analysis: {
  contentLength: 40,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: false
}
üîµ INFO: üèóÔ∏è [req_1755433111137_i83bkl7wl] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Refreshing authentication...
Fetching new access token...
Successfully obtained access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 90,
    "totalTokenCount": 389,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 90
      }
    ],
    "thoughtsTokenCount": 299
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:18:31.545049Z",
  "responseId": "l8ihaJmiIf6Hm9IPnr2N2QY"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 90,
      totalTokenCount: 389,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 299
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:18:31.545049Z',
    responseId: 'l8ihaJmiIf6Hm9IPnr2N2QY'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating characters: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 91,
    "totalTokenCount": 340,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 91
      }
    ],
    "thoughtsTokenCount": 249
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:18:33.557525Z",
  "responseId": "mcihaNWDIoeImecP08fR8QM"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 91,
      totalTokenCount: 340,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 249
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:18:33.557525Z',
    responseId: 'mcihaNWDIoeImecP08fR8QM'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating scenes: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 76,
    "totalTokenCount": 275,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 76
      }
    ],
    "thoughtsTokenCount": 199
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:18:35.353725Z",
  "responseId": "m8ihaL3LFc2Dm9IPlu_Z0QI"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 76,
      totalTokenCount: 275,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 199
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:18:35.353725Z',
    responseId: 'm8ihaL3LFc2Dm9IPlu_Z0QI'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating final pitch: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755433111137_i83bkl7wl] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755433111137_i83bkl7wl] Request completed successfully undefined
 POST /api/process-youtube 200 in 5731ms
 ‚óã Compiling / ...
 ‚úì Compiled / in 1710ms (1610 modules)
Component rendered
 GET / 200 in 2117ms
Component rendered
 GET / 200 in 25ms
Component rendered
Component rendered
 GET / 200 in 220ms
 GET / 200 in 215ms
Component rendered
Component rendered
 GET / 200 in 237ms
 GET / 200 in 253ms
 ‚óã Compiling /favicon.ico ...
 ‚úì Compiled /favicon.ico in 863ms (1642 modules)
 GET /favicon.ico 200 in 970ms
Component rendered
Component rendered
 GET / 200 in 536ms
 GET / 200 in 508ms
 GET /favicon.ico 200 in 38ms
 GET /favicon.ico 200 in 31ms
üîµ INFO: Cache cleanup: removed 1 expired entries undefined
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
Component rendered
 GET / 200 in 95ms
 ‚óã Compiling /_not-found ...
 ‚úì Compiled /_not-found in 651ms (2634 modules)
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 735ms
 GET /favicon.ico 200 in 17ms
 ‚úì Compiled /api/process-youtube in 193ms (1985 modules)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Initializing Gemini Service with config: {
  projectId: 'fechen-aifactory',
  location: 'us-central1',
  model: 'gemini-2.5-flash',
  timeout: 60000
}
Vertex AI client initialized successfully
üîµ INFO: üöÄ [req_1755433722906_si2xmo6fd] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755433722906_si2xmo6fd] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=U-JmrDgGRVOuY3Ww',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T12:28:42.907Z'
}
üîµ INFO: üé¨ [req_1755433722906_si2xmo6fd] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755433722906_si2xmo6fd] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=U-JmrDgGRVOuY3Ww undefined
üîµ INFO: Attempting operation: YouTube metadata extraction (attempt 1/3) undefined
üîµ INFO: üé¨ Starting enhanced Shorts processing for AVPVDt6lXYw undefined
üîµ INFO: üéØ Performing video analysis for Shorts: AVPVDt6lXYw undefined
üîµ INFO: üì• Downloading video for analysis: AVPVDt6lXYw undefined
üîµ INFO: üé• Starting enhanced multi-format download for Shorts: AVPVDt6lXYw undefined
üîµ INFO: üìã Video info retrieved { videoId: 'AVPVDt6lXYw', duration: 26, availableFormats: 0 }
üîµ INFO: üì• Attempt 1/12: Trying format "worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]" { videoId: 'AVPVDt6lXYw' }
üîµ INFO: üì• Executing download command {
  videoId: 'AVPVDt6lXYw',
  selector: 'worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]',
  command: 'yt-dlp --format "[URL]"'
}
üîµ INFO: üìä Download successful {
  videoId: 'AVPVDt6lXYw',
  filePath: '/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755433726675.mp4',
  format: 'mp4',
  mimeType: 'video/mp4',
  sizeBytes: 1926609,
  sizeMB: '1.84'
}
üîµ INFO: ‚úÖ Download successful with format selector: "worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]" { videoId: 'AVPVDt6lXYw', format: 'mp4', fileSize: 1926609 }
üîµ INFO: ‚úÖ File validation passed {
  filePath: '/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755433726675.mp4',
  size: 1926609
}
üîµ INFO: ‚úÖ Multi-format download completed in 6125ms {
  videoId: 'AVPVDt6lXYw',
  format: 'mp4',
  mimeType: 'video/mp4',
  duration: 26,
  fileSize: 1926609
}
üîµ INFO: ü§ñ Analyzing video content: /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755433726675.mp4 undefined
üîµ INFO: üé¨ Starting video analysis for AVPVDt6lXYw undefined
üîµ INFO: üì§ Uploading to GCS: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755433729111.mp4 undefined
üîµ INFO: üé¨ Starting real Gemini 2.5 Flash video analysis for: AVPVDt6lXYw undefined
üîµ INFO: üìπ Video GCS URI: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755433729111.mp4 undefined
üîµ INFO: üéØ Attempting analysis with prompt strategy 1/2 undefined
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Refreshing authentication...
Fetching new access token...
Successfully obtained access token
üîµ INFO: üîë Access token obtained for video analysis undefined
üîµ INFO: üöÄ Sending multimodal request to Gemini 2.5 Flash {
  videoId: 'AVPVDt6lXYw',
  gcsUri: 'gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755433729111.mp4',
  promptLength: 657
}
üîµ INFO: ‚úÖ Gemini 2.5 Flash response received {
  videoId: 'AVPVDt6lXYw',
  responseStructure: 'Valid',
  candidatesCount: 1
}
üîµ INFO: üìÑ Generated analysis text length: 953 undefined
üîµ INFO: ‚úÖ Real video analysis completed {
  videoId: 'AVPVDt6lXYw',
  responseLength: 953,
  preview: '```json\n' +
    '{\n' +
    '  "generatedTranscript": "Áî¢ÂìÅÂà©ÊΩ§ÊÄéÈ∫ºÊü•ÔºüÂÖ¨ÈñãË∂Ö‰ΩéÊàêÊú¨Ë≤®Ê∫ê„ÄÇAmazonÊàíÊåáÊúàÈä∑78Ëê¨ÁæéÈáëÔºåÊàêÊú¨ÂÉÖ0.35ÁæéÈáëÔºåÂà©ÊΩ§È©ö‰∫∫„ÄÇ",\n' +
    '  "sceneBreakdown": [\n' +
    '    {\n' +
    '      "startTime": 0,\n' +
    '      "endTime": 25,\n' +
    '      "description": "‰∏ªÊí≠Ë¨õËß£Áî¢ÂìÅÂà©ÊΩ§",\n' +
    '      "se',
  promptStrategy: 1
}
üîµ INFO: üßπ Cleaned JSON for parsing {
  videoId: 'AVPVDt6lXYw',
  originalLength: 953,
  cleanedLength: 941,
  preview: '{\n' +
    '  "generatedTranscript": "Áî¢ÂìÅÂà©ÊΩ§ÊÄéÈ∫ºÊü•ÔºüÂÖ¨ÈñãË∂Ö‰ΩéÊàêÊú¨Ë≤®Ê∫ê„ÄÇAmazonÊàíÊåáÊúàÈä∑78Ëê¨ÁæéÈáëÔºåÊàêÊú¨ÂÉÖ0.35ÁæéÈáëÔºåÂà©ÊΩ§È©ö‰∫∫„ÄÇ",\n' +
    '  "sceneBreakdown": [\n' +
    '    {\n' +
    '      "startTime": 0,\n' +
    '      "endTime": 25,\n' +
    '      "description": "‰∏ªÊí≠Ë¨õËß£Áî¢ÂìÅÂà©ÊΩ§",\n' +
    '      "setting": '
}
üîµ INFO: üìä Analysis parsing successful {
  videoId: 'AVPVDt6lXYw',
  transcriptLength: 48,
  scenesCount: 1,
  charactersCount: 1,
  dialoguesCount: 0
}
üîµ INFO: üßπ Cleaned up GCS temp file: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755433729111.mp4 undefined
üîµ INFO: ‚úÖ Video analysis completed in 19705ms { videoId: 'AVPVDt6lXYw', confidence: 0.9 }
üîµ INFO: üßπ Cleaned up temporary file: /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755433726675.mp4 undefined
üü¢ DEBUG: Cache set: youtube:AVPVDt6lXYw:shorts (type: shorts, ttl: 900000ms) undefined
üü° WARN: Processing event completed {
  eventId: 'evt_1755433722907_owee1r21s',
  duration: 25913,
  success: true,
  strategy: 'video_analysis_enhanced',
  error: undefined
}
üîµ INFO: ‚úÖ [req_1755433722906_si2xmo6fd] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755433722906_si2xmo6fd] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755433722906_si2xmo6fd] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755433722906_si2xmo6fd] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "totalTokenCount": 384,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "thoughtsTokenCount": 299
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:29:09.010222Z",
  "responseId": "FcuhaO5P15-Z5w_R4f-QCA"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 85,
      totalTokenCount: 384,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 299
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:29:09.010222Z',
    responseId: 'FcuhaO5P15-Z5w_R4f-QCA'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating characters: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "totalTokenCount": 335,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "thoughtsTokenCount": 249
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:29:11.169227Z",
  "responseId": "F8uhaIuqCoqTmecP7tramAk"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 86,
      totalTokenCount: 335,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 249
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:29:11.169227Z',
    responseId: 'F8uhaIuqCoqTmecP7tramAk'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating scenes: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "totalTokenCount": 270,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "thoughtsTokenCount": 199
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:29:12.575448Z",
  "responseId": "GMuhaNiPI_6Hm9IPnr2N2QY"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 71,
      totalTokenCount: 270,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 199
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:29:12.575448Z',
    responseId: 'GMuhaNiPI_6Hm9IPnr2N2QY'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating final pitch: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755433722906_si2xmo6fd] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755433722906_si2xmo6fd] Request completed successfully undefined
 POST /api/process-youtube 200 in 31432ms
Component rendered
 GET / 200 in 252ms
Component rendered
 GET / 200 in 17ms
Component rendered
 GET / 200 in 23ms
Component rendered
 GET / 200 in 52ms
Component rendered
 GET / 200 in 25ms
Component rendered
Component rendered
Component rendered
Component rendered
 GET / 200 in 373ms
 GET / 200 in 355ms
 GET / 200 in 436ms
 GET / 200 in 467ms
 GET /favicon.ico 200 in 197ms
 GET /favicon.ico 200 in 192ms
 GET /favicon.ico 200 in 190ms
 GET /favicon.ico 200 in 189ms
 POST /api/process-youtube 200 in 269ms
üîµ INFO: üöÄ [req_1755434051895_mni984pb6] Starting YouTube processing request undefined
üîµ INFO: üöÄ [req_1755434051898_f484pokcr] Starting YouTube processing request undefined
üî¥ ERROR: üí• [req_1755434051898_f484pokcr] Critical API error: {
  error: 'Unexpected end of JSON input',
  stack: 'SyntaxError: Unexpected end of JSON input\n' +
    '    at JSON.parse (<anonymous>)\n' +
    '    at parseJSONFromBytes (node:internal/deps/undici/undici:5738:19)\n' +
    '    at successSteps (node:internal/deps/undici/undici:5719:27)\n' +
    '    at consumeBody (node:internal/deps/undici/undici:5725:9)\n' +
    '    at NextRequest.json (node:internal/deps/undici/undici:5665:18)\n' +
    '    at POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:21:117)\n' +
    '    at /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57234\n' +
    '    at /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/trace/tracer.js:140:36\n' +
    '    at NoopContextManager.with (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/@opentelemetry/api/build/src/context/NoopContextManager.js:25:19)\n' +
    '    at ContextAPI.with (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/@opentelemetry/api/build/src/api/context.js:60:46)\n' +
    '    at NoopTracer.startActiveSpan (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/@opentelemetry/api/build/src/trace/NoopTracer.js:65:31)\n' +
    '    at ProxyTracer.startActiveSpan (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/@opentelemetry/api/build/src/trace/ProxyTracer.js:36:24)\n' +
    '    at /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/trace/tracer.js:122:103\n' +
    '    at NoopContextManager.with (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/@opentelemetry/api/build/src/context/NoopContextManager.js:25:19)\n' +
    '    at ContextAPI.with (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/@opentelemetry/api/build/src/api/context.js:60:46)\n' +
    '    at NextTracerImpl.trace (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/trace/tracer.js:122:28)\n' +
    '    at /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:48896\n' +
    '    at AsyncLocalStorage.run (node:async_hooks:346:14)\n' +
    '    at Object.wrap (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:40958)\n' +
    '    at /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:47472\n' +
    '    at AsyncLocalStorage.run (node:async_hooks:346:14)\n' +
    '    at Object.wrap (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:38293)\n' +
    '    at /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:47434\n' +
    '    at AsyncLocalStorage.run (node:async_hooks:346:14)\n' +
    '    at eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46881)\n' +
    '    at eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58771)\n' +
    '    at doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:60)\n' +
    '    at cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:34)\n' +
    '    at ResponseCache.get (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/response-cache/index.js:49:26)\n' +
    '    at DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:53)',
  timestamp: '2025-08-17T12:34:11.901Z'
} undefined
üîµ INFO: üìã [req_1755434051895_mni984pb6] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=U-JmrDgGRVOuY3Ww',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T12:34:11.908Z'
}
üîµ INFO: üé¨ [req_1755434051895_mni984pb6] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755434051895_mni984pb6] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=U-JmrDgGRVOuY3Ww undefined
üü¢ DEBUG: Cache hit: youtube:AVPVDt6lXYw:shorts (access count: 1) undefined
üîµ INFO: Cache hit for AVPVDt6lXYw undefined
üîµ INFO: ‚úÖ [req_1755434051895_mni984pb6] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755434051895_mni984pb6] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755434051895_mni984pb6] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755434051895_mni984pb6] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
 POST /api/process-youtube 200 in 731ms
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "Êä±Ê≠âÔºåÊÇ®Êèê‰æõÁöÑ„ÄåÂÖßÂÆπ„ÄçÊòØÁ©∫ÁöÑ„ÄÇË´ãÊèê‰æõÂÖ∑È´îÁöÑÂÖßÂÆπÔºåÊàëÊâçËÉΩÁÇ∫ÊÇ®ÂàÜÊûê‰∏¶ÂâµÂª∫ËßíËâ≤„ÄÇ"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -1.3402938842773438
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "candidatesTokenCount": 27,
    "totalTokenCount": 279,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 27
      }
    ],
    "thoughtsTokenCount": 167
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:34:13.155801Z",
  "responseId": "RcyhaJnBCdefmecP0eH_kAg"
}
JSON recovery failed, using fallback: SyntaxError: Unexpected token 'Êä±', "Êä±Ê≠âÔºåÊÇ®Êèê‰æõÁöÑ„ÄåÂÖßÂÆπ"... is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.recoverTruncatedJson (webpack-internal:///(rsc)/./lib/structured-output-service.ts:165:33)
    at StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:58:44)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating characters: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:58:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Component rendered
 GET / 200 in 90ms
Component rendered
 GET / 200 in 95ms
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "totalTokenCount": 335,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "thoughtsTokenCount": 249
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:34:14.531910Z",
  "responseId": "RsyhaMa7IIeImecP08fR8QM"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 86,
      totalTokenCount: 335,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 249
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:34:14.531910Z',
    responseId: 'RsyhaMa7IIeImecP08fR8QM'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating scenes: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
 GET /favicon.ico 200 in 65ms
 GET /favicon.ico 200 in 25ms
üîµ INFO: üöÄ [req_1755434056543_y4903smb4] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755434056543_y4903smb4] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=U-JmrDgGRVOuY3Ww',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T12:34:16.546Z'
}
üîµ INFO: üé¨ [req_1755434056543_y4903smb4] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755434056543_y4903smb4] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=U-JmrDgGRVOuY3Ww undefined
üü¢ DEBUG: Cache hit: youtube:AVPVDt6lXYw:shorts (access count: 2) undefined
üîµ INFO: Cache hit for AVPVDt6lXYw undefined
üîµ INFO: ‚úÖ [req_1755434056543_y4903smb4] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755434056543_y4903smb4] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755434056543_y4903smb4] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755434056543_y4903smb4] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "totalTokenCount": 270,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "thoughtsTokenCount": 199
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:34:15.991149Z",
  "responseId": "R8yhaK2_PI2Cm9IPpK2IgAg"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 71,
      totalTokenCount: 270,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 199
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:34:15.991149Z',
    responseId: 'R8yhaK2_PI2Cm9IPpK2IgAg'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating final pitch: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755434051895_mni984pb6] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755434051895_mni984pb6] Request completed successfully undefined
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "totalTokenCount": 384,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "thoughtsTokenCount": 299
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:34:17.551140Z",
  "responseId": "ScyhaOTRIYibm9IP-c-U6Qw"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 85,
      totalTokenCount: 384,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 299
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:34:17.551140Z',
    responseId: 'ScyhaOTRIYibm9IP-c-U6Qw'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating characters: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "totalTokenCount": 335,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "thoughtsTokenCount": 249
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:34:19.276870Z",
  "responseId": "S8yhaIbzEP6Hm9IPnr2N2QY"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 86,
      totalTokenCount: 335,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 249
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:34:19.276870Z',
    responseId: 'S8yhaIbzEP6Hm9IPnr2N2QY'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating scenes: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "totalTokenCount": 270,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "thoughtsTokenCount": 199
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:34:20.695546Z",
  "responseId": "TMyhaPq5Ks2Dm9IPlu_Z0QI"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 71,
      totalTokenCount: 270,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 199
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:34:20.695546Z',
    responseId: 'TMyhaPq5Ks2Dm9IPlu_Z0QI'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating final pitch: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755434056543_y4903smb4] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755434056543_y4903smb4] Request completed successfully undefined
 POST /api/process-youtube 200 in 5330ms
Component rendered
 GET / 200 in 48ms
Component rendered
 GET / 200 in 23ms
Component rendered
 GET / 200 in 31ms
 GET /favicon.ico 200 in 5ms
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
Component rendered
 GET / 200 in 47ms
Component rendered
 GET / 200 in 17ms
Component rendered
 GET / 200 in 25ms
 GET /favicon.ico 200 in 6ms
Component rendered
 GET / 200 in 41ms
Component rendered
 GET / 200 in 32ms
Component rendered
 GET / 200 in 24ms
 GET /favicon.ico 200 in 8ms
üîµ INFO: üöÄ [req_1755434888966_xiiuzo0zr] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755434888966_xiiuzo0zr] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T12:48:08.968Z'
}
üîµ INFO: üé¨ [req_1755434888966_xiiuzo0zr] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755434888966_xiiuzo0zr] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H undefined
üü¢ DEBUG: Cache expired: youtube:AVPVDt6lXYw:shorts undefined
üîµ INFO: Attempting operation: YouTube metadata extraction (attempt 1/3) undefined
üîµ INFO: üé¨ Starting enhanced Shorts processing for AVPVDt6lXYw undefined
üîµ INFO: üéØ Performing video analysis for Shorts: AVPVDt6lXYw undefined
üîµ INFO: üì• Downloading video for analysis: AVPVDt6lXYw undefined
üîµ INFO: üé• Starting enhanced multi-format download for Shorts: AVPVDt6lXYw undefined
üîµ INFO: üìã Video info retrieved { videoId: 'AVPVDt6lXYw', duration: 26, availableFormats: 0 }
üîµ INFO: üì• Attempt 1/12: Trying format "worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]" { videoId: 'AVPVDt6lXYw' }
üîµ INFO: üì• Executing download command {
  videoId: 'AVPVDt6lXYw',
  selector: 'worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]',
  command: 'yt-dlp --format "[URL]"'
}
üîµ INFO: üìä Download successful {
  videoId: 'AVPVDt6lXYw',
  filePath: '/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755434892103.mp4',
  format: 'mp4',
  mimeType: 'video/mp4',
  sizeBytes: 1926609,
  sizeMB: '1.84'
}
üîµ INFO: ‚úÖ Download successful with format selector: "worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]" { videoId: 'AVPVDt6lXYw', format: 'mp4', fileSize: 1926609 }
üîµ INFO: ‚úÖ File validation passed {
  filePath: '/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755434892103.mp4',
  size: 1926609
}
üîµ INFO: ‚úÖ Multi-format download completed in 5400ms {
  videoId: 'AVPVDt6lXYw',
  format: 'mp4',
  mimeType: 'video/mp4',
  duration: 26,
  fileSize: 1926609
}
üîµ INFO: ü§ñ Analyzing video content: /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755434892103.mp4 undefined
üîµ INFO: üé¨ Starting video analysis for AVPVDt6lXYw undefined
üîµ INFO: üì§ Uploading to GCS: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755434894451.mp4 undefined
üîµ INFO: üé¨ Starting real Gemini 2.5 Flash video analysis for: AVPVDt6lXYw undefined
üîµ INFO: üìπ Video GCS URI: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755434894451.mp4 undefined
üîµ INFO: üéØ Attempting analysis with prompt strategy 1/2 undefined
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
üîµ INFO: üîë Access token obtained for video analysis undefined
üîµ INFO: üöÄ Sending multimodal request to Gemini 2.5 Flash {
  videoId: 'AVPVDt6lXYw',
  gcsUri: 'gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755434894451.mp4',
  promptLength: 657
}
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
üîµ INFO: ‚úÖ Gemini 2.5 Flash response received {
  videoId: 'AVPVDt6lXYw',
  responseStructure: 'Valid',
  candidatesCount: 1
}
üîµ INFO: üìÑ Generated analysis text length: 1213 undefined
üîµ INFO: ‚úÖ Real video analysis completed {
  videoId: 'AVPVDt6lXYw',
  responseLength: 1213,
  preview: '```json\n' +
    '{\n' +
    '  "generatedTranscript": "ÂΩ±ÁâáÊè≠Èú≤AmazonÁÜ±Èä∑ÊàíÊåáÂà©ÊΩ§„ÄÇÂîÆÂÉπ15.99ÁæéÂÖÉÔºåÊàêÊú¨ÂÉÖ0.35ÁæéÂÖÉÔºåÂà©ÊΩ§È´òÈÅî45ÂÄç„ÄÇ",\n' +
    '  "sceneBreakdown": [\n' +
    '    {\n' +
    '      "startTime": 0,\n' +
    '      "endTime": 7,\n' +
    '      "description": "‰ªãÁ¥πÁî¢ÂìÅÈ´òÈä∑ÂîÆÈ°ç",\n' +
    '      "settin',
  promptStrategy: 1
}
üîµ INFO: üßπ Cleaned JSON for parsing {
  videoId: 'AVPVDt6lXYw',
  originalLength: 1213,
  cleanedLength: 1201,
  preview: '{\n' +
    '  "generatedTranscript": "ÂΩ±ÁâáÊè≠Èú≤AmazonÁÜ±Èä∑ÊàíÊåáÂà©ÊΩ§„ÄÇÂîÆÂÉπ15.99ÁæéÂÖÉÔºåÊàêÊú¨ÂÉÖ0.35ÁæéÂÖÉÔºåÂà©ÊΩ§È´òÈÅî45ÂÄç„ÄÇ",\n' +
    '  "sceneBreakdown": [\n' +
    '    {\n' +
    '      "startTime": 0,\n' +
    '      "endTime": 7,\n' +
    '      "description": "‰ªãÁ¥πÁî¢ÂìÅÈ´òÈä∑ÂîÆÈ°ç",\n' +
    '      "setting": "Áèæ‰ª£ÂÆ§'
}
üîµ INFO: üìä Analysis parsing successful {
  videoId: 'AVPVDt6lXYw',
  transcriptLength: 45,
  scenesCount: 2,
  charactersCount: 1,
  dialoguesCount: 0
}
üîµ INFO: üßπ Cleaned up GCS temp file: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755434894451.mp4 undefined
üîµ INFO: ‚úÖ Video analysis completed in 23408ms { videoId: 'AVPVDt6lXYw', confidence: 0.9 }
üîµ INFO: üßπ Cleaned up temporary file: /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755434892103.mp4 undefined
üü¢ DEBUG: Cache set: youtube:AVPVDt6lXYw:shorts (type: shorts, ttl: 900000ms) undefined
üü° WARN: Processing event completed {
  eventId: 'evt_1755434888969_27dx9g2d9',
  duration: 28892,
  success: true,
  strategy: 'video_analysis_enhanced',
  error: undefined
}
üîµ INFO: ‚úÖ [req_1755434888966_xiiuzo0zr] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755434888966_xiiuzo0zr] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755434888966_xiiuzo0zr] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755434888966_xiiuzo0zr] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "totalTokenCount": 384,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "thoughtsTokenCount": 299
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:48:38.051030Z",
  "responseId": "ps-haNaOA_q0nvgPjqSm8AU"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 85,
      totalTokenCount: 384,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 299
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:48:38.051030Z',
    responseId: 'ps-haNaOA_q0nvgPjqSm8AU'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating characters: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:54:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "totalTokenCount": 335,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "thoughtsTokenCount": 249
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:48:40.171492Z",
  "responseId": "qM-haOS7Coa0nvgPrtmFgQY"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 86,
      totalTokenCount: 335,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 249
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:48:40.171492Z',
    responseId: 'qM-haOS7Coa0nvgPrtmFgQY'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating scenes: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:82:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model"
      },
      "finishReason": "MAX_TOKENS"
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "totalTokenCount": 270,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "thoughtsTokenCount": 199
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:48:42.019020Z",
  "responseId": "qs-haMyUAYat698PiaP16QY"
}
Gemini response issue: {
  hasText: false,
  textLength: 0,
  finishReason: 'MAX_TOKENS',
  structure: {
    candidates: [ [Object] ],
    usageMetadata: {
      promptTokenCount: 71,
      totalTokenCount: 270,
      trafficType: 'ON_DEMAND',
      promptTokensDetails: [Array],
      thoughtsTokenCount: 199
    },
    modelVersion: 'gemini-2.5-flash',
    createTime: '2025-08-17T12:48:42.019020Z',
    responseId: 'qs-haMyUAYat698PiaP16QY'
  }
}
Error calling Gemini directly: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Error generating final pitch: Error: Gemini hit token limit (MAX_TOKENS) - response truncated
    at generateTextDirect (webpack-internal:///(rsc)/./lib/gemini-direct.ts:66:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:109:30)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755434888966_xiiuzo0zr] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755434888966_xiiuzo0zr] Request completed successfully undefined
 POST /api/process-youtube 200 in 34546ms
 ‚úì Compiled in 790ms (2599 modules)
 ‚úì Compiled in 225ms (989 modules)
 ‚úì Compiled in 222ms (1610 modules)
 ‚úì Compiled in 210ms (1610 modules)
 ‚úì Compiled in 125ms (1610 modules)
 ‚óã Compiling /api/process-text ...
 ‚úì Compiled /api/process-text in 670ms (1801 modules)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Initializing Gemini Service with config: {
  projectId: 'fechen-aifactory',
  location: 'us-central1',
  model: 'gemini-2.5-flash',
  timeout: 60000
}
Vertex AI client initialized successfully
üîµ INFO: üöÄ [text_1755435480037_k66jkhlk9] Starting text processing request undefined
üîµ INFO: üìù [text_1755435480037_k66jkhlk9] Request parameters: {
  textLength: 76,
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  style: 'inspiring',
  timestamp: '2025-08-17T12:58:00.037Z'
}
üîµ INFO: ü§ñ [text_1755435480037_k66jkhlk9] Generating pitch from text content undefined
Generating text with Gemini: {
  model: 'gemini-2.5-flash',
  promptLength: 464,
  temperature: 0.7,
  maxTokens: 4000,
  timeout: 60000
}
Attempt 1/3 with model: gemini-2.5-flash
Generated text successfully in 19441ms: {
  textLength: 2056,
  textPreview: 'Â•ΩÁöÑÔºåÈÄôÊòØ‰∏ÄÂÄãÁÇ∫ÂΩ±ÁâáÈáèË∫´ÊâìÈÄ†ÁöÑ„ÄÅÂÖ∑ÊúâÂÆåÊï¥Êïò‰∫ãÁµêÊßã‰∏îÈ¢®Ê†ºÊøÄÂãµ‰∫∫ÂøÉÁöÑÁπÅÈ´î‰∏≠ÊñáÊèêÊ°à„ÄÇ\n' +
    '\n' +
    '---\n' +
    '\n' +
    '**ÂΩ±ÁâáÊèêÊ°àÂêçÁ®±ÔºöÁôæÂπ¥Êñ∞ÁîüÔºöÁßëÊäÄÈªû‰∫ÆËÄÅÂ∫óÂÇ≥Êâø‰πãË∑Ø**\n' +
    '\n' +
    '**ÁõÆÊ®ôÂèóÁúæÔºö** Â∞ãÊ±ÇÂâµÊñ∞ËΩâÂûãÁöÑÂ∞è‰ºÅÊ•≠‰∏ª„ÄÅÁßëÊäÄÊÑõÂ•Ω...'
}
üîµ INFO: ‚úÖ [text_1755435480037_k66jkhlk9] Text processing completed successfully undefined
 POST /api/process-text 200 in 20266ms
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
üìä Performance Summary:
   Overall Health: healthy
   Total Operations: 0
   Average Response Time: 0.00ms
   Error Rate: 0.00%
Component rendered
 GET / 200 in 240ms
 ‚úì Compiled /_not-found in 477ms (2793 modules)
 GET /.well-known/appspecific/com.chrome.devtools.json 404 in 543ms
 ‚úì Compiled /favicon.ico in 151ms (1831 modules)
 GET /favicon.ico 200 in 241ms
 ‚úì Compiled /api/process-youtube in 471ms (1987 modules)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Initializing Gemini Service with config: {
  projectId: 'fechen-aifactory',
  location: 'us-central1',
  model: 'gemini-2.5-flash',
  timeout: 60000
}
Vertex AI client initialized successfully
üîµ INFO: üöÄ [req_1755435540993_36fk3shq3] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755435540993_36fk3shq3] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T12:59:00.993Z'
}
üîµ INFO: üé¨ [req_1755435540993_36fk3shq3] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755435540993_36fk3shq3] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H undefined
üîµ INFO: Attempting operation: YouTube metadata extraction (attempt 1/3) undefined
üîµ INFO: üé¨ Starting enhanced Shorts processing for AVPVDt6lXYw undefined
üîµ INFO: üéØ Performing video analysis for Shorts: AVPVDt6lXYw undefined
üîµ INFO: üì• Downloading video for analysis: AVPVDt6lXYw undefined
üîµ INFO: üé• Starting enhanced multi-format download for Shorts: AVPVDt6lXYw undefined
üîµ INFO: üìã Video info retrieved { videoId: 'AVPVDt6lXYw', duration: 26, availableFormats: 0 }
üîµ INFO: üì• Attempt 1/12: Trying format "worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]" { videoId: 'AVPVDt6lXYw' }
üîµ INFO: üì• Executing download command {
  videoId: 'AVPVDt6lXYw',
  selector: 'worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]',
  command: 'yt-dlp --format "[URL]"'
}
üîµ INFO: üìä Download successful {
  videoId: 'AVPVDt6lXYw',
  filePath: '/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755435543797.mp4',
  format: 'mp4',
  mimeType: 'video/mp4',
  sizeBytes: 1926609,
  sizeMB: '1.84'
}
üîµ INFO: ‚úÖ Download successful with format selector: "worst[height<=480][ext=mp4]/bestvideo[height<=480][ext=mp4]+bestaudio[ext=m4a]/worst[ext=mp4]" { videoId: 'AVPVDt6lXYw', format: 'mp4', fileSize: 1926609 }
üîµ INFO: ‚úÖ File validation passed {
  filePath: '/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755435543797.mp4',
  size: 1926609
}
üîµ INFO: ‚úÖ Multi-format download completed in 5507ms {
  videoId: 'AVPVDt6lXYw',
  format: 'mp4',
  mimeType: 'video/mp4',
  duration: 26,
  fileSize: 1926609
}
üîµ INFO: ü§ñ Analyzing video content: /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755435543797.mp4 undefined
üîµ INFO: üé¨ Starting video analysis for AVPVDt6lXYw undefined
üîµ INFO: üì§ Uploading to GCS: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755435546594.mp4 undefined
üîµ INFO: üé¨ Starting real Gemini 2.5 Flash video analysis for: AVPVDt6lXYw undefined
üîµ INFO: üìπ Video GCS URI: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755435546594.mp4 undefined
üîµ INFO: üéØ Attempting analysis with prompt strategy 1/2 undefined
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Refreshing authentication...
Fetching new access token...
Successfully obtained access token
üîµ INFO: üîë Access token obtained for video analysis undefined
üîµ INFO: üöÄ Sending multimodal request to Gemini 2.5 Flash {
  videoId: 'AVPVDt6lXYw',
  gcsUri: 'gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755435546594.mp4',
  promptLength: 657
}
üîµ INFO: ‚úÖ Gemini 2.5 Flash response received {
  videoId: 'AVPVDt6lXYw',
  responseStructure: 'Valid',
  candidatesCount: 1
}
üîµ INFO: üìÑ Generated analysis text length: 1117 undefined
üîµ INFO: ‚úÖ Real video analysis completed {
  videoId: 'AVPVDt6lXYw',
  responseLength: 1117,
  preview: '```json\n' +
    '{\n' +
    '  "generatedTranscript": "Áî∑Â≠ê‰ªãÁ¥πAmazonÊàíÊåáÂà©ÊΩ§ÔºåÂ∞çÊØî1688ÊàêÊú¨ÔºåÊè≠Á§∫45ÂÄçÂÉπÂ∑Æ„ÄÇ",\n' +
    '  "sceneBreakdown": [\n' +
    '    {\n' +
    '      "startTime": 0,\n' +
    '      "endTime": 8,\n' +
    '      "description": "Áî∑Â≠ê‰ªãÁ¥πÁî¢ÂìÅ",\n' +
    '      "setting": "ÂÆ§ÂÖßÊ≤ôÁôº",\n' +
    '   ',
  promptStrategy: 1
}
üîµ INFO: üßπ Cleaned JSON for parsing {
  videoId: 'AVPVDt6lXYw',
  originalLength: 1117,
  cleanedLength: 1105,
  preview: '{\n' +
    '  "generatedTranscript": "Áî∑Â≠ê‰ªãÁ¥πAmazonÊàíÊåáÂà©ÊΩ§ÔºåÂ∞çÊØî1688ÊàêÊú¨ÔºåÊè≠Á§∫45ÂÄçÂÉπÂ∑Æ„ÄÇ",\n' +
    '  "sceneBreakdown": [\n' +
    '    {\n' +
    '      "startTime": 0,\n' +
    '      "endTime": 8,\n' +
    '      "description": "Áî∑Â≠ê‰ªãÁ¥πÁî¢ÂìÅ",\n' +
    '      "setting": "ÂÆ§ÂÖßÊ≤ôÁôº",\n' +
    '      "acti'
}
üîµ INFO: üìä Analysis parsing successful {
  videoId: 'AVPVDt6lXYw',
  transcriptLength: 32,
  scenesCount: 2,
  charactersCount: 1,
  dialoguesCount: 0
}
üîµ INFO: üßπ Cleaned up GCS temp file: gs://storycraft-video-temp/shorts/AVPVDt6lXYw_1755435546594.mp4 undefined
üîµ INFO: ‚úÖ Video analysis completed in 18338ms { videoId: 'AVPVDt6lXYw', confidence: 0.9 }
üîµ INFO: üßπ Cleaned up temporary file: /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/temp/shorts/shorts_AVPVDt6lXYw_1755435543797.mp4 undefined
üü¢ DEBUG: Cache set: youtube:AVPVDt6lXYw:shorts (type: shorts, ttl: 900000ms) undefined
üü° WARN: Processing event completed {
  eventId: 'evt_1755435540993_oj8375mg8',
  duration: 23942,
  success: true,
  strategy: 'video_analysis_enhanced',
  error: undefined
}
üîµ INFO: ‚úÖ [req_1755435540993_36fk3shq3] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755435540993_36fk3shq3] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755435540993_36fk3shq3] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755435540993_36fk3shq3] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "Áî±ÊñºÊÇ®Êú™Êèê‰æõÂÖ∑È´îÂÖßÂÆπÔºåÊàëÂ∞áÊ†πÊìö‰∏ÄÂÄãËôõÊßãÁöÑÂ†¥ÊôØ‰æÜÂâµÂª∫ÂÖ©ÂÄãËßíËâ≤Ôºå‰ª•Â±ïÁ§∫ÊâÄÈúÄÁöÑËº∏Âá∫Ê†ºÂºèÔºö\n\n**ËôõÊßãÂÖßÂÆπÔºö**\nÂú®‰∏ÄÂ∫ßË¢´ÈÅ∫ÂøòÁöÑÂúñÊõ∏È§®Ê∑±ËôïÔºå‰∏Ä‰ΩçÂπ¥ÈÇÅÁöÑÂÆàË≠∑ËÄÖËàá‰∏Ä‰ΩçÂπ¥ËºïÁöÑÊé¢Èö™ÂÆ∂Áõ∏ÈÅá„ÄÇÂÆàË≠∑ËÄÖÊìÅÊúâÁÑ°Êï∏Âè§ËÄÅÁü•Ë≠òÔºåËÄåÊé¢Èö™ÂÆ∂ÂâáÊ∏¥ÊúõÊè≠ÈñãÂúñÊõ∏È§®ÁöÑÁßòÂØÜÔºåÂ∞ãÊâæÂ§±ËêΩÁöÑÂØ∂Ëóè„ÄÇ\n\n```json\n{\n  \"characters\": [\n    {\n      \"name\": \"Êõ∏ÁøÅ\",\n      \"age\": 48,\n      \"gender\": \"Áî∑ÊÄß\",\n      \"voice\": \"Ê≤âÁ©©\",\n      \"appearance\": \"ÁôΩÈ´ÆÂæÆÈ¨öÔºåÁúºÁ•ûÊ∑±ÈÇÉ\",\n      \"personality\": \"ÂçöÂ≠∏Â§öËÅûÔºåÂÖßÊñÇÁùøÊô∫\",\n      \"motivation\": \"ÂÆàË≠∑Áü•Ë≠òÔºåÈÅøÂÖçÊø´Áî®\"\n    },\n    {\n      \"name\": \"Â∞ãÈ¢®\",\n      \"age\": 25,\n      \"gender\": \"Áî∑ÊÄß\",\n      \"voice\": \"Ê∏Ö‰∫Æ\",\n      \"appearance\": \"Ë∫´ÂΩ¢ÁüØÂÅ•ÔºåÁõÆÂÖâÈä≥Âà©\",\n      \"personality\": \"Â•ΩÂ•áÂøÉÈáçÔºåÂãáÊï¢Â†ÖÊØÖ\",\n      \"motivation\": \"Êè≠ÈñãÁßòÂØÜÔºåÂ∞ãÊâæÁúüÁõ∏\"\n    }\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -0.9910293856534091
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "candidatesTokenCount": 275,
    "totalTokenCount": 1738,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 275
      }
    ],
    "thoughtsTokenCount": 1378
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:59:25.136851Z",
  "responseId": "LdKhaJOtCM2Dm9IPlu_Z0QI"
}
Error generating characters: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:58:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "```json\n{\n  \"scenes\": [\n    {\n      \"sceneNumber\": 1,\n      \"location\": \"ËåÇÂØÜÂè¢Êûó‰∏≠ÁöÑÂ§±ËêΩÁ•ûÂªü\",\n      \"timeOfDay\": \"‰∏äÂçà\",\n      \"atmosphere\": \"ÊΩÆÊøï„ÄÅÂè§ËÄÅ„ÄÅÁ•ûÁßò\",\n      \"keyAction\": \"Êí•ÈñãËó§ËîìÔºåÁôºÁèæÈö±ËóèÁöÑÂÖ•Âè£\",\n      \"emotionalTone\": \"ÊúüÂæÖ„ÄÅÈ©öÂ•á\",\n      \"visualElements\": [\"ÈùíËãîË¶ÜËìãÁöÑÁü≥Â°ä\", \"ÈôΩÂÖâÁ©øÈÄèÊ®πÂÜ†\", \"Áõ§ÁπûÁöÑËó§Ëîì\", \"Ê®°Á≥äÁöÑÈõïÂàª\"],\n      \"duration\": 20\n    },\n    {\n      \"sceneNumber\": 2,\n      \"location\": \"ÂÜ∞Â∑ùÊ∑±ËôïÁöÑËóçËâ≤ÂÜ∞Ê¥û\",\n      \"timeOfDay\": \"‰∏ãÂçà\",\n      \"atmosphere\": \"Âà∫È™®„ÄÅÂØÇÈùú„ÄÅÁ©∫Èùà\",\n      \"keyAction\": \"Â∞èÂøÉÁøºÁøºÂú∞Á©øÈÅéÂÜ∞ËÑäÔºåÁôºÁèæË¢´ÂáçÁµêÁöÑÁâ©È´î\",\n      \"emotionalTone\": \"Êï¨Áïè„ÄÅÂ≠§Áç®„ÄÅÂæÆÂ∞èÁöÑÊÅêÊáº\",\n      \"visualElements\": [\"ÈñÉÁàçÁöÑÂÜ∞Â£Å\", \"ÂπΩËóçÁöÑÂÖâÁ∑ö\", \"ÂÜ∞Êü±\", \"Ë¢´ÂÜ∞Â∞ÅÁöÑÈÅ†Âè§Â∑•ÂÖ∑\"],\n      \"duration\": 20\n    },\n    {\n      \"sceneNumber\": 3,\n      \"location\": \"Ê¥ªÁÅ´Â±±ÈÇäÁ∑£ÁöÑËßÄÊ∏¨Èªû\",\n      \"timeOfDay\": \"Â§úÊôö\",\n      \"atmosphere\": \"ÁÅºÁÜ±„ÄÅÂç±Èö™„ÄÅÂ£ØËßÄ\",\n      \"keyAction\": \"Êû∂Ë®≠Ë®≠ÂÇôÔºåËßÄÂØüÁøªÈ®∞ÁöÑÁÜîÂ≤©Êπñ\",\n      \"emotionalTone\": \"Â∞àÊ≥®„ÄÅËÖé‰∏äËÖ∫Á¥†„ÄÅÂ∞çËá™ÁÑ∂ÁöÑÊï¨Áïè\",\n      \"visualElements\": [\"Ê©òÁ¥ÖËâ≤ÁöÑÁÜîÂ≤©ÊµÅ\", \"Á°´Á£∫ÁÖôÈúß\", \"ÊºÜÈªëÁöÑÁÅ´Â±±Â≤©\", \"ÈÅ†ËôïÁöÑÊòüÁ©∫\"],\n      \"duration\": 20\n    }\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -0.6603198271888306
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "candidatesTokenCount": 411,
    "totalTokenCount": 1972,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 411
      }
    ],
    "thoughtsTokenCount": 1475
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:59:33.398326Z",
  "responseId": "NdKhaPanGKyWmecPoa-TkQM"
}
Error generating scenes: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:86:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "```json\n{\n  \"title\": \"ÂØÇÈùúÁöÑËø¥Èüø\",\n  \"genre\": \"ÁßëÂπªÊá∏ÁñëÂÜíÈö™Áâá\",\n  \"targetAudience\": \"ÈùíÂ∞ëÂπ¥ÂèäÊàê‰∫∫\",\n  \"coreMessage\": \"Êé¢Á¥¢Êú™Áü•‰∏çÂÉÖÊòØÁôºÁèæÔºåÊõ¥ÊòØÂ∞çËá™Ë∫´Â≠òÂú®ÊÑèÁæ©ÁöÑËøΩÂïèÔºå‰ª•ÂèäÊñáÊòéËààË°∞ÁöÑË≠¶Á§∫„ÄÇ\",\n  \"finalPitch\": \"‰∫ûÂÄ´Ôºå‰∏Ä‰ΩçÈ£ΩÁ∂ìÈ¢®ÈúúÁöÑÊòüÈöõÊé¢Á¥¢ËÄÖÔºåË¢´Ê¥æÈÅ£Âà∞‰ª£Ëôü„ÄåÂØÇÈùúÊòü„ÄçÁöÑÈÅôÈÅ†Ë°åÊòüÔºåË™øÊü•‰∏ÄÁµÑÁ•ûÁßòÁöÑËÉΩÈáè‰ø°Ëôü„ÄÇÂú®ÈÇ£Ë£°Ôºå‰ªñÊÑèÂ§ñÁôºÁèæ‰∫Ü‰∏ÄÂ∫ß‰øùÂ≠òÂÆåÂ•ΩÁöÑÂÆèÂÅâÂ§ñÊòüÂüéÂ∏ÇÔºåÂçªÁ©∫ÁÑ°‰∏Ä‰∫∫ÔºåÂè™Áïô‰∏ãÁÑ°Êï∏ÂÖàÈÄ≤ÁßëÊäÄÁöÑÈÅ∫Ë∑°ÂíåÂàªÂú®ÁâÜ‰∏äÁöÑÂè§ËÄÅÈ†êË®Ä„ÄÇÈö®Ëëó‰∫ûÂÄ´Ê∑±ÂÖ•Ë™øÊü•Ôºå‰ªñÈÄêÊº∏ÊãºÊπäÂá∫‰∏ÄÂÄãÈ©ö‰∫∫ÁöÑÁúüÁõ∏ÔºöÈÄôÂÄãÈ´òÂ∫¶ÁôºÈÅîÁöÑÊñáÊòé‰∏¶ÈùûÊªÖ‰∫°ÔºåËÄåÊòØÂõ†ÁÇ∫È†êË¶ãÂà∞ÂÆáÂÆôÁ¥öÁöÑÂ®ÅËÑÖËÄåÈõÜÈ´îÈÅ∑ÂæôÔºåÁïô‰∏ã‰∫ÜË≠¶ÂëäÁµ¶Âæå‰æÜËÄÖ„ÄÇ‰∫ûÂÄ´ÊÑèË≠òÂà∞ÔºåÈÄô‰∏çÂÉÖÊòØÈóúÊñº‰∏ÄÂÄãÂ§±ËêΩÊñáÊòéÁöÑÊïÖ‰∫ãÔºåÊõ¥ÊòØÂ∞ç‰∫∫È°ûÂëΩÈÅãÁöÑÊ≤âÈáçÈ†êÁ§∫„ÄÇ‰ªñÂøÖÈ†àËß£ËÆÄÈÄô‰∫õË®äÊÅØÔºåÊ±∫ÂÆöÊòØÂê¶Ë¶ÅÂ∞áÈÄô‰ª§‰∫∫‰∏çÂÆâÁöÑÁôºÁèæÂ∏∂ÂõûÂú∞ÁêÉÔºåÊè≠Á§∫‰∫∫È°ûÊú™‰æÜÂèØËÉΩÈù¢Ëá®ÁöÑËÄÉÈ©ó„ÄÇ\",\n  \"tags\": [\n    \"ÁßëÂπª\",\n    \"Êá∏Áñë\",\n    \"Êé¢Á¥¢\",\n    \"Â§ñÊòüÊñáÊòé\",\n    \"Âì≤Â≠∏\",\n    \"Êú™‰æÜ\"\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -1.402776846108726
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "candidatesTokenCount": 313,
    "totalTokenCount": 1792,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 313
      }
    ],
    "thoughtsTokenCount": 1408
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T12:59:42.042679Z",
  "responseId": "PtKhaLfNAtefmecP0eH_kAg"
}
Error generating final pitch: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:113:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755435540993_36fk3shq3] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755435540993_36fk3shq3] Request completed successfully undefined
 POST /api/process-youtube 200 in 50906ms
üîµ INFO: üöÄ [req_1755435719988_7v7ipxg2b] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755435719988_7v7ipxg2b] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T13:01:59.993Z'
}
üîµ INFO: üé¨ [req_1755435719988_7v7ipxg2b] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755435719988_7v7ipxg2b] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H undefined
üü¢ DEBUG: Cache hit: youtube:AVPVDt6lXYw:shorts (access count: 1) undefined
üîµ INFO: Cache hit for AVPVDt6lXYw undefined
üîµ INFO: ‚úÖ [req_1755435719988_7v7ipxg2b] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755435719988_7v7ipxg2b] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755435719988_7v7ipxg2b] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755435719988_7v7ipxg2b] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "ÂæàÊä±Ê≠âÔºåÊÇ®Êèê‰æõÁöÑ„ÄåÂÖßÂÆπ„ÄçÊòØÁ©∫ÁöÑ„ÄÇÁÇ∫‰∫ÜËÉΩÁÇ∫ÊÇ®ÂâµÂª∫ËßíËâ≤ÔºåÊàëÈúÄË¶Å‰∏Ä‰∫õËÉåÊôØ‰ø°ÊÅØÊàñÊñáÊú¨ÂÖßÂÆπ‰æÜÈÄ≤Ë°åÂàÜÊûê„ÄÇ\n\nÁî±ÊñºÊ≤íÊúâÂÖßÂÆπÔºåÊàëÂ∞áÂü∫Êñº‰∏ÄÂÄãÈÄöÁî®ÊÉÖÂ¢ÉÔºà‰æãÂ¶ÇÔºö‰∏ÄÂÄãÁèæ‰ª£ÈÉΩÂ∏ÇÁöÑÂ•áÂπªÊïÖ‰∫ãÔºâÁÇ∫ÊÇ®ÂâµÂª∫ÂÖ©ÂÄãËßíËâ≤Ôºå‰ª•Á§∫ÁØÑÊâÄÈúÄÁöÑJSONÊ†ºÂºè„ÄÇ\n\n```json\n{\n  \"characters\": [\n    {\n      \"name\": \"ÊûóÈ¢®\",\n      \"age\": 28,\n      \"gender\": \"Áî∑ÊÄß\",\n      \"voice\": \"Ê≤âÁ©©\",\n      \"appearance\": \"ÈªëË°£ÔºåÁúºÁ•ûÈä≥Âà©\",\n      \"personality\": \"ÂÖßÊñÇÔºåËßÄÂØüÂäõÂº∑\",\n      \"motivation\": \"Â∞ãÊâæÁúüÁõ∏\"\n    },\n    {\n      \"name\": \"ÊùéÁé•\",\n      \"age\": 35,\n      \"gender\": \"Â•≥ÊÄß\",\n      \"voice\": \"Ê∫´ÂíåËÄåÂ†ÖÂÆö\",\n      \"appearance\": \"Èï∑È´ÆÔºåÊ∞£Ë≥™ÂÑ™ÈõÖ\",\n      \"personality\": \"ÁêÜÊô∫ÔºåÂØåÊúâÂêåÊÉÖÂøÉ\",\n      \"motivation\": \"Á∂≠Ë≠∑Áß©Â∫è\"\n    }\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -1.2924331095208765
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "candidatesTokenCount": 241,
    "totalTokenCount": 1521,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 241
      }
    ],
    "thoughtsTokenCount": 1195
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T13:02:01.023592Z",
  "responseId": "ydKhaKi4AfqAm9IPucqbqA4"
}
Error generating characters: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:58:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "```json\n{\n  \"scenes\": [\n    {\n      \"sceneNumber\": 1,\n      \"location\": \"ËåÇÂØÜÂè¢ÊûóÊ∑±Ëôï\",\n      \"timeOfDay\": \"Ê∏ÖÊô®\",\n      \"atmosphere\": \"ÊΩÆÊøï„ÄÅÁ•ûÁßò„ÄÅÂÖÖÊªøÁîüÊ©ü\",\n      \"keyAction\": \"Êí•ÈñãËó§ËîìÔºåÁôºÁèæÈö±ËîΩÁöÑÂè§ËÄÅÁü≥ÈñÄ\",\n      \"emotionalTone\": \"ÊúüÂæÖ„ÄÅÂ•ΩÂ•á„ÄÅ‰∏ÄÁµ≤ËààÂ•Æ\",\n      \"visualElements\": [\"ÊøÉÂØÜÁöÑËó§Ëîì\", \"ÈôΩÂÖâÁ©øÈÄèÊ®πÂÜ†\", \"ÊΩÆÊøïÁöÑÊ≥•Âúü\", \"ÈõïÂàªËëóÁ¨¶ËôüÁöÑÁü≥ÈñÄ\"],\n      \"duration\": 20\n    },\n    {\n      \"sceneNumber\": 2,\n      \"location\": \"ÈªëÊöóÊΩÆÊøïÁöÑÂú∞‰∏ãÊ¥ûÁ©¥\",\n      \"timeOfDay\": \"‰∏çË©≥\",\n      \"atmosphere\": \"ÂπΩÈñâ„ÄÅËø¥ËÅ≤„ÄÅÊΩõÂú®Âç±Èö™\",\n      \"keyAction\": \"ÊâãÈõªÁ≠íÂÖâÊùüÊéÉÈÅéÔºåÂ∞èÂøÉÁøºÁøºÂú∞Ë∑®Ë∂äÊ∑±Ê∑µ\",\n      \"emotionalTone\": \"Á∑äÂºµ„ÄÅË¨πÊÖé„ÄÅÂ†ÖÂÆö\",\n      \"visualElements\": [\"Êª¥Ê∞¥ÁöÑÈêò‰π≥Áü≥\", \"Ê∑±‰∏çË¶ãÂ∫ïÁöÑË£ÇÁ∏´\", \"Â≤©Â£Å‰∏äÁöÑÊøïÊªëÈùíËãî\", \"Êé¢Èö™ËÄÖÂëºÂê∏ÁöÑÁôΩÈúß\"],\n      \"duration\": 25\n    },\n    {\n      \"sceneNumber\": 3,\n      \"location\": \"Â§±ËêΩÊñáÊòéÁöÑÁ©∫‰∏≠Ëä±Âúí\",\n      \"timeOfDay\": \"ÂçàÂæå\",\n      \"atmosphere\": \"ÂÆèÂÅâ„ÄÅÂØßÈùú„ÄÅË∂ÖÂá°ËÑ´‰øó\",\n      \"keyAction\": \"Á´ôÂú®Êá∏Â¥ñÈÇäÁ∑£Ôºå‰øØÁû∞Â£ØÈ∫óÁöÑÁÄëÂ∏ÉËàáÁï∞ÂüüÊ§çÁâ©\",\n      \"emotionalTone\": \"È©öÂòÜ„ÄÅÊªøË∂≥„ÄÅÂπ≥Èùú\",\n      \"visualElements\": [\"Â±§ÁñäÁöÑÊ¢ØÁî∞\", \"ÂΩ©Ëôπ‰∏ãÁöÑÁÄëÂ∏É\", \"ÁôºÂÖâÁöÑÂ•áÁï∞Ëä±Êúµ\", \"ÈÅ†ËôïÁöÑÊµÆÂ≥∂\"],\n      \"duration\": 25\n    }\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -0.7503860002458803
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "candidatesTokenCount": 421,
    "totalTokenCount": 2011,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 421
      }
    ],
    "thoughtsTokenCount": 1504
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T13:02:08.316280Z",
  "responseId": "0NKhaPimE4ibm9IP-c-U6Qw"
}
Error generating scenes: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:86:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "```json\n{\n  \"title\": \"ÊòüÂ°µÁöÑÁõ°È†≠\",\n  \"genre\": \"ÁßëÂπªÂì≤Â≠∏Âäá\",\n  \"targetAudience\": \"Êàê‰∫∫„ÄÅÁßëÂπªÊÑõÂ•ΩËÄÖ„ÄÅÂ∞çÂ≠òÂú®Ë≠∞È°åÊÑüËààË∂£ÁöÑËßÄÁúæ\",\n  \"coreMessage\": \"Âú®ÂÆáÂÆôÁöÑÁµÇÁÑâÔºåÁúüÊ≠£ÁöÑÊé¢Á¥¢‰∏çÊòØÂ∞ãÊâæÊñ∞ÁöÑÈñãÂßãÔºåËÄåÊòØÁêÜËß£ËàäÁöÑÁµêÊùüÔºå‰∏¶Âú®ÂÖ∂‰∏≠ÊâæÂà∞Â≠òÂú®ÁöÑÊÑèÁæ©ËàáÂ∏åÊúõ„ÄÇ\",\n  \"finalPitch\": \"Âú®ÂÆáÂÆôÁÜµÂ¢ûËá≥Ê•µËá¥„ÄÅËê¨Áâ©ÁöÜÊ≠∏ÊñºÂØÇÊªÖ‰πãÈöõÔºåÊúÄÂæåÁöÑ„ÄåÊé¢Á¥¢ËÄÖ„Äç‚Äî‚ÄîËâæÁëûÊñØÔºåËÇ©Ë≤†ËëóÂ∞ãÊâæ„ÄåÂÆáÂÆô‰πãÂøÉ„ÄçÁöÑ‰ΩøÂëΩÂïüÁ®ã„ÄÇ‰ªñÁ©øË∂äÁÑ°Áõ°ÁöÑÊòüÂ°µÂª¢Â¢üÔºåÂ≠§Áç®Âú∞ËøΩÊ∫ØÊñáÊòéÁöÑÁóïË∑°ÔºåÂè™ÁÇ∫Êé¢Â∞ã‰∏ÄÁµ≤ÈÄÜËΩâÁµÇÁµêÁöÑÂ∏åÊúõ„ÄÇÊ≠∑Á∂ìÁ£®Èõ£ÔºåËâæÁëûÊñØÊúÄÁµÇÊäµÈÅîÂÇ≥Ë™™‰∏≠ÁöÑËµ∑Ê∫ê‰πãÂú∞ÔºåÂçªÊ≤íÊúâÊâæÂà∞ÂØ¶È´îÁöÑÊïëË¥ñÔºåËÄåÊòØÈ†òÊÇü‰∫ÜÂÆáÂÆôÂæ™Áí∞ÁöÑÁúüË´¶ÔºöËê¨Áâ©ÁöÑÁµÇÁµê‰∫¶ÊòØÊñ∞ÁîüÁöÑÂ∫èÊõ≤„ÄÇÈÄô‰ªΩË∂ÖË∂äÁîüÊ≠ªÁöÑÊ¥ûÂØüÔºåË≥¶‰∫àËâæÁëûÊñØÂπ≥ÈùúËàáÂ∞çÂ≠òÂú®ÁöÑÂÖ®Êñ∞ÁêÜËß£ÔºåË≠âÊòéÁúüÊ≠£ÁöÑÂ∏åÊúõ‰∏çÂú®ÊñºÈÄÉÈÅøÔºåËÄåÂú®ÊñºÊ∑±Â∫¶ÁöÑÊ¥ûÂØüËàáÊé•Âèó„ÄÇ\",\n  \"tags\": [\n    \"ÁßëÂπª\",\n    \"Âì≤Â≠∏\",\n    \"Êú´Êó•\",\n    \"Â∏åÊúõ\",\n    \"Êé¢Á¥¢\"\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -1.8867946315456081
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "candidatesTokenCount": 296,
    "totalTokenCount": 1767,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 296
      }
    ],
    "thoughtsTokenCount": 1400
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T13:02:17.785923Z",
  "responseId": "2dKhaIP8L-KMm9IPzITjqQc"
}
Error generating final pitch: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:113:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755435719988_7v7ipxg2b] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755435719988_7v7ipxg2b] Request completed successfully undefined
 POST /api/process-youtube 200 in 27384ms
üîµ INFO: Cache cleanup: removed 1 expired entries undefined
üîµ INFO: üöÄ [req_1755435888204_4lbqkamox] Starting YouTube processing request undefined
üîµ INFO: üìã [req_1755435888204_4lbqkamox] Request parameters: {
  url: 'https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H',
  targetLanguage: 'ÁπÅÈ´î‰∏≠Êñá',
  useStructuredOutput: true,
  timestamp: '2025-08-17T13:04:48.206Z'
}
üîµ INFO: üé¨ [req_1755435888204_4lbqkamox] Initializing YouTube processing service undefined
üîµ INFO: üì∫ [req_1755435888204_4lbqkamox] Processing YouTube content: https://youtube.com/shorts/AVPVDt6lXYw?si=t4hq-TCbAgN8Vs7H undefined
üü¢ DEBUG: Cache hit: youtube:AVPVDt6lXYw:shorts (access count: 2) undefined
üîµ INFO: Cache hit for AVPVDt6lXYw undefined
üîµ INFO: ‚úÖ [req_1755435888204_4lbqkamox] YouTube processing completed: {
  strategy: 'video_analysis_enhanced',
  confidence: 0.95,
  hasVideoAnalysis: true,
  contentType: 'shorts'
}
üîµ INFO: ü§ñ [req_1755435888204_4lbqkamox] Starting pitch generation with structured output undefined
üîµ INFO: üìù [req_1755435888204_4lbqkamox] Content analysis: {
  contentLength: 0,
  isShorts: true,
  hasTranscript: false,
  hasVideoAnalysis: true
}
üîµ INFO: üèóÔ∏è [req_1755435888204_4lbqkamox] Using structured output for Traditional Chinese undefined
üîÑ Structured output attempt 1/2
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "Áî±ÊñºÂÖßÂÆπÊú™Êèê‰æõÔºåÊàëÂ∞áÊ†πÊìö‰∏ÄËà¨Êïò‰∫ãÂÖßÂÆπÁöÑÂ∏∏Ë¶ãËßíËâ≤È°ûÂûãÔºåÂâµÂª∫ÂÖ©ÂÄãÁØÑ‰æãËßíËâ≤‰ª•Á¨¶ÂêàËº∏Âá∫Ê†ºÂºèË¶ÅÊ±Ç„ÄÇ\n\n```json\n{\n  \"characters\": [\n    {\n      \"name\": \"ÊûóÈùú\",\n      \"age\": 32,\n      \"gender\": \"Â•≥ÊÄß\",\n      \"voice\": \"Ê∫´Âíå\",\n      \"appearance\": \"ÂèäËÇ©ÈªëÈ´ÆÔºåÊà¥Á¥∞Ê°ÜÁúºÈè°ÔºåÁ©øËëóÁ∞°Ê®∏\",\n      \"personality\": \"ÂÜ∑ÈùúÔºåËßÄÂØüÂäõÊïèÈä≥ÔºåÂØåÊúâÂêåÊÉÖÂøÉ\",\n      \"motivation\": \"Êè≠Èú≤ÁúüÁõ∏Ôºå‰øùË≠∑ÁÑ°ËæúËÄÖ\"\n    },\n    {\n      \"name\": \"Èô≥Ââõ\",\n      \"age\": 48,\n      \"gender\": \"Áî∑ÊÄß\",\n      \"voice\": \"‰ΩéÊ≤â\",\n      \"appearance\": \"Ë∫´ÊùêÈ≠ÅÊ¢ßÔºåÈù¢ÊúâÈ¢®ÈúúÔºåÂ∏∏Á©øËàäÂ§æÂÖã\",\n      \"personality\": \"Ê≠£Áõ¥ÔºåÂõ∫Âü∑ÔºåÂ§ñÂÜ∑ÂÖßÁÜ±\",\n      \"motivation\": \"ÂΩåË£úÈÅéÂéªÁöÑÈåØË™§ÔºåÂ∞ãÊ±ÇÊïëË¥ñ\"\n    }\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -1.0352841147893592
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 85,
    "candidatesTokenCount": 237,
    "totalTokenCount": 1400,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 85
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 237
      }
    ],
    "thoughtsTokenCount": 1078
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T13:04:49.226277Z",
  "responseId": "cdOhaOXnDdefmecP0eH_kAg"
}
Error generating characters: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateCharactersWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:58:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:17:36)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "```json\n{\n  \"scenes\": [\n    {\n      \"sceneNumber\": 1,\n      \"location\": \"ÂçóÁæéÊ¥≤Âè¢ÊûóÊ∑±ËôïÁöÑÂ§±ËêΩÁ•ûÂªüÂÖ•Âè£\",\n      \"timeOfDay\": \"ÈªéÊòé\",\n      \"atmosphere\": \"ÊΩÆÊøï„ÄÅÂè§ËÄÅ„ÄÅÂÖÖÊªøÊú™Áü•\",\n      \"keyAction\": \"Êé¢Á¥¢ËÄÖÊí•ÈñãËåÇÂØÜÁöÑËó§ËîìÔºåÁôºÁèæË¢´ËãîËòöË¶ÜËìãÁöÑÂ∑®Áü≥Êã±ÈñÄ\",\n      \"emotionalTone\": \"ËààÂ•Æ„ÄÅÂ•ΩÂ•á„ÄÅ‰∏ÄÁµ≤Êï¨Áïè\",\n      \"visualElements\": [\"ÈôΩÂÖâÁ©øÈÄèÊ®πÂÜ†ÁöÑÂÖâÊùü\", \"Áõ§Ê†πÈåØÁØÄÁöÑÂè§Ê®π\", \"ÊøïÊΩ§ÁöÑÈùíËãîÂíåËï®È°û\", \"ÈõïÂàªÊúâÁ•ûÁßòÁ¨¶ËôüÁöÑÁü≥Â°ä\"],\n      \"duration\": 20\n    },\n    {\n      \"sceneNumber\": 2,\n      \"location\": \"Âª£ÈóäÁöÑÁ¥ÖËâ≤Ê≤ôÊº†Â≥ΩË∞∑\",\n      \"timeOfDay\": \"ÂÇçÊôö\",\n      \"atmosphere\": \"‰πæÁá•„ÄÅÂö¥ÈÖ∑„ÄÅÈ¢®Êö¥Â∞áËá≥\",\n      \"keyAction\": \"Êé¢Á¥¢ËÄÖËâ±Èõ£Âú∞ÊîÄÁà¨Èô°Â≥≠ÁöÑÊ≤ôÂ≤©Â£ÅÔºåÈÅ†ËôïÊ≤ôÂ°µÊö¥Êº∏Ëµ∑\",\n      \"emotionalTone\": \"Â†ÖÊØÖ„ÄÅÁñ≤ÊÜä„ÄÅË≠¶ÊÉï\",\n      \"visualElements\": [\"Á¥ÖËâ≤ÁöÑÊ≤ôÂ≤©Âú∞Ë≤å\", \"Ë¢´È¢®ËùïÁöÑÂ≤©Áü≥\", \"ÊòèÈªÉÁöÑÂ§ïÈôΩÈ§òÊöâ\", \"ÈÅ†ÊñπÂú∞Âπ≥Á∑ö‰∏äÁöÑÊ≤ôÂ°µÊü±\"],\n      \"duration\": 25\n    },\n    {\n      \"sceneNumber\": 3,\n      \"location\": \"Ê∑±Êµ∑‰∏≠ÁôºÂÖâÁöÑÊú™Áü•Ê¥ûÁ©¥ÂÖ•Âè£\",\n      \"timeOfDay\": \"‰∏çÈÅ©Áî®ÔºàÊ∑±Êµ∑Ôºâ\",\n      \"atmosphere\": \"ÂØÇÈùú„ÄÅÂπΩÊ∑±„ÄÅÂ•áÁï∞ÁöÑÂÖâËäí\",\n      \"keyAction\": \"Êé¢Á¥¢ËÄÖÊΩõÂÖ•Ê¥ûÁ©¥ÔºåË¢´ÂÖßÈÉ®Êï£ÁôºÁöÑÁîüÁâ©ÂÖâËäíÂíåÂ•áÁâπÁµêÊßãÁí∞Áπû\",\n      \"emotionalTone\": \"È©öÂòÜ„ÄÅÊï¨Áïè„ÄÅÂ≠§Áç®\",\n      \"visualElements\": [\"ÊºÇÊµÆÁöÑÁôºÂÖâÊ∞¥ÊØç\", \"Ê∞¥Êô∂Ëà¨ÁöÑÂ•áÁï∞Ê§çÁâ©\", \"Ê∑±ËóçËâ≤Âà∞Á¥´Ëâ≤ÁöÑÊ∞¥È´î\", \"Êé¢Á¥¢ËÄÖÁöÑÊΩõÊ∞¥È†≠ÁáàÂÖâÊùü\"],\n      \"duration\": 25\n    }\n  ]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -0.7161317581400681
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 86,
    "candidatesTokenCount": 477,
    "totalTokenCount": 2041,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 86
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 477
      }
    ],
    "thoughtsTokenCount": 1478
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T13:04:55.808931Z",
  "responseId": "d9OhaOOvMYibm9IP-c-U6Qw"
}
Error generating scenes: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.generateScenesWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:86:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:19:32)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
Vertex AI Configuration:
  Project ID: fechen-aifactory
  Location: us-central1
  Veo Model: veo-001
  Gemini Model: gemini-2.5-flash
  GCS Videos Storage URI: Not set
  YouTube API Key: Set
Using cached access token
Gemini response structure: {
  "candidates": [
    {
      "content": {
        "role": "model",
        "parts": [
          {
            "text": "```json\n{\n  \"title\": \"ÊòüËæ∞ÁöÑÂëºÂñö\",\n  \"genre\": \"ÁßëÂπªÂÜíÈö™Áâá\",\n  \"targetAudience\": \"‰∏ÄËà¨ËßÄÁúæ\",\n  \"coreMessage\": \"‰∫∫È°ûÂ∞çÊú™Áü•ÁöÑÂ•ΩÂ•áËàáÊé¢Á¥¢Á≤æÁ•ûÔºå‰ª•ÂèäÊñáÊòéÁöÑÂÇ≥ÊâøËàáÂ§±ËêΩ„ÄÇ\",\n  \"finalPitch\": \"ËâæÁëûÂÖãÔºå‰∏ÄÂêçÁ∂ìÈ©óË±êÂØåÁöÑÊòüÈöõÊé¢Á¥¢ËÄÖÔºåÂÅ∂ÁÑ∂ÁôºÁèæ‰∫Ü‰∏ÄÊûö‰æÜËá™Â§±ËêΩÊñáÊòéÁöÑÁ•ûÁßò‰ø°Ê®ô„ÄÇ‰ø°Ê®ôÊåáÂºï‰ªñÂâçÂæÄ‰∏ÄÂÄãË¢´ÊôÇÈñìÈÅ∫ÂøòÁöÑË°åÊòü„ÄÇÂú®ÈÇ£Ë£°Ôºå‰ªñ‰∏çÂÉÖË¶ÅÈù¢Â∞çÊòüÁêÉ‰∏äÂö¥ÈÖ∑ÁöÑÁí∞Â¢ÉÂíåÊΩõ‰ºèÁöÑÊú™Áü•ÁîüÁâ©ÔºåÈÇÑË¶ÅËß£Èñã‰∏ÄÂÄãÈóúÊñºË©≤ÊñáÊòéÁÇ∫‰ΩïÊ∂àÈÄùÁöÑÂè§ËÄÅË¨éÂúò„ÄÇËâæÁëûÂÖãÂøÖÈ†àÊ±∫ÂÆöÔºåÊòØÊè≠Èú≤ÈÄôÂèØËÉΩÈ°õË¶ÜÁèæÊúâË™çÁü•ÁöÑÁúüÁõ∏ÔºåÈÇÑÊòØËÆìÂÆÉÊ∞∏ÈÅ†Ê≤âÁù°ÊñºÂ°µÂüÉ‰πã‰∏≠„ÄÇ\",\n  \"tags\": [\"ÊòüÈöõÊé¢Á¥¢\", \"Â§±ËêΩÊñáÊòé\", \"ÂÜíÈö™\", \"ÁßëÂπª\", \"ÁôºÁèæ\"]\n}\n```"
          }
        ]
      },
      "finishReason": "STOP",
      "avgLogprobs": -1.6810418286369841
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 71,
    "candidatesTokenCount": 206,
    "totalTokenCount": 1801,
    "trafficType": "ON_DEMAND",
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 71
      }
    ],
    "candidatesTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 206
      }
    ],
    "thoughtsTokenCount": 1524
  },
  "modelVersion": "gemini-2.5-flash",
  "createTime": "2025-08-17T13:05:04.931405Z",
  "responseId": "gNOhaM3sOKyWmecPoa-TkQM"
}
Error generating final pitch: SyntaxError: "[object Object]" is not valid JSON
    at JSON.parse (<anonymous>)
    at StructuredOutputService.compileFinalPitchWithFallback (webpack-internal:///(rsc)/./lib/structured-output-service.ts:113:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async StructuredOutputService.generateStructuredPitch (webpack-internal:///(rsc)/./lib/structured-output-service.ts:21:41)
    at async POST (webpack-internal:///(rsc)/./app/api/process-youtube/route.ts:84:32)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228
    at async eT.execute (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)
    at async eT.handle (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)
    at async doRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1366:42)
    at async cacheEntry.responseCache.get.routeKind (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1588:28)
    at async DevServer.renderToResponseWithComponentsImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1496:28)
    at async DevServer.renderPageComponent (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1924:24)
    at async DevServer.renderToResponseImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:1962:32)
    at async DevServer.pipeImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:922:25)
    at async NextNodeServer.handleCatchallRenderRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/next-server.js:272:17)
    at async DevServer.handleRequestImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/base-server.js:818:17)
    at async /Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:339:20
    at async Span.traceAsyncFn (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/trace/trace.js:154:20)
    at async DevServer.handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/dev/next-dev-server.js:336:24)
    at async invokeRender (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:179:21)
    at async handleRequest (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:359:24)
    at async requestHandlerImpl (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/router-server.js:383:13)
    at async Server.requestListener (/Users/shouian99/Desktop/macmbp/saas_app/storycraft-main/node_modules/next/dist/server/lib/start-server.js:141:13)
‚úÖ Structured output generation successful
üîµ INFO: ‚úÖ [req_1755435888204_4lbqkamox] Structured pitch generated successfully (71 chars) undefined
üîµ INFO: üéâ [req_1755435888204_4lbqkamox] Request completed successfully undefined
 POST /api/process-youtube 200 in 25439ms
 ‚úì Compiled in 639ms (2599 modules)
[?25h
